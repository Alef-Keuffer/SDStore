<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="611px" preserveAspectRatio="none" style="width:853px;height:611px;background:#FFFFFF;" version="1.1" viewBox="0 0 853 611" width="853px" zoomAndPan="magnify"><defs/><g><ellipse cx="427" cy="595" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="427.5" cy="595.5" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="463.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="839.71" x="7" y="7"/><rect fill="#FFFFFF" height="432.2038" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="837.71" x="8" y="37.0679"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="846.71" y1="36.0679" y2="36.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="380.855" y="26.9659">listening loop</text><ellipse cx="463.83" cy="57.0679" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="387.83" y="104.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="392.83" y="129.4999">blocked on FIFO read</text><g id="lloop.pqueue"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="268" x="329.83" y="383.0679"/><line style="stroke:#181818;stroke-width:0.5;" x1="329.83" x2="597.83" y1="412.1358" y2="412.1358"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="414.33" y="403.0339">process queue</text><ellipse cx="340.33" cy="428.7038" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235" x="347.83" y="432.1018">execute any tasks that are possible</text><ellipse cx="340.33" cy="447.7717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="347.83" y="451.1697">send "processing" here</text></g><rect fill="#F1F1F1" height="147.3396" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="648.5" x="139.83" y="199.0679"/><rect fill="#FFFFFF" height="116.2717" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="646.5" x="140.83" y="229.1358"/><line style="stroke:#181818;stroke-width:0.5;" x1="139.83" x2="788.33" y1="228.1358" y2="228.1358"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="406.08" y="219.0339">process message</text><g id="lloop.pmes.status"><rect fill="#F1F1F1" height="58.1358" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="169" x="151.83" y="259.1358"/><line style="stroke:#181818;stroke-width:0.5;" x1="151.83" x2="320.83" y1="288.2038" y2="288.2038"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="215.83" y="279.1018">status</text><ellipse cx="162.33" cy="304.7717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="169.83" y="308.1697">send status to client</text></g><g id="lloop.pmes.procfile"><rect fill="#F1F1F1" height="96.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="154" x="339.33" y="240.1358"/><line style="stroke:#181818;stroke-width:0.5;" x1="339.33" x2="493.33" y1="269.2038" y2="269.2038"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="388.33" y="260.1018">proc-file</text><ellipse cx="349.83" cy="285.7717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="357.33" y="289.1697">proc-file</text><ellipse cx="349.83" cy="304.8396" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="357.33" y="308.2376">add task to queue</text><ellipse cx="349.83" cy="323.9075" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="357.33" y="327.3055">send "pending"</text></g><g id="lloop.pmes.finished_task"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="268" x="511.33" y="249.6358"/><line style="stroke:#181818;stroke-width:0.5;" x1="511.33" x2="779.33" y1="278.7038" y2="278.7038"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="601.33" y="269.6018">finished_task</text><ellipse cx="521.83" cy="295.2717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="529.33" y="298.6697">update running info</text><ellipse cx="521.83" cy="314.3396" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235" x="529.33" y="317.7376">(monitor already sent "completed")</text></g><!--MD5=[9cab67c1658621a5f0ab8925afbfc4d1]
link *start*lloop to fblock--><g id="link_*start*lloop_fblock"><path d="M463.83,67.1079 C463.83,75.2579 463.83,87.6279 463.83,98.6679 " fill="none" id="*start*lloop-to-fblock" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="463.83,103.9579,467.83,94.9579,463.83,98.9579,459.83,94.9579,463.83,103.9579" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3fcfc0c3f476e413e60df4facbb3fb5d]
link fblock to pmes--><g id="link_fblock_pmes"><path d="M463.83,144.2179 C463.83,157.1979 463.83,175.2879 463.83,193.7579 " fill="none" id="fblock-to-pmes" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="463.83,198.9779,467.83,189.9779,463.83,193.9779,459.83,189.9779,463.83,198.9779" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="464.83" y="176.9649">has data</text></g><!--MD5=[5efc9a4e4c037c5762523f0451d985dc]
link pmes to pqueue--><g id="link_pmes_pqueue"><path d="M463.83,346.2079 C463.83,357.0479 463.83,367.9179 463.83,377.8579 " fill="none" id="pmes-to-pqueue" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="463.83,382.9779,467.83,373.9779,463.83,377.9779,459.83,373.9779,463.83,382.9779" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[987e6092593f91351240b075cfb8351b]
link pqueue to fblock--><g id="link_pqueue_fblock"><path d="M598.14,407.5279 C679.24,396.5679 771.65,377.5079 796.83,346.0679 C837.68,295.0779 837.71,250.0279 796.83,199.0679 C765.86,160.4579 633.34,140.7179 545.1,131.6679 " fill="none" id="pqueue-to-fblock" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="539.88,131.1379,548.4359,136.016,544.855,131.6368,549.2342,128.056,539.88,131.1379" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[db1daee58f179c2188b9f7e94e5c8bb9]
link fblock to pqueue--><g id="link_fblock_pqueue"><path d="M387.7,127.7979 C282.44,133.3479 100.75,149.9779 59.83,199.0679 C18,249.2579 18.03,295.8579 59.83,346.0679 C93.35,386.3279 221.42,404.9179 324.5,413.4479 " fill="none" id="fblock-to-pqueue" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="329.7,413.8679,321.0487,409.161,324.716,413.4681,320.4089,417.1354,329.7,413.8679" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="60.83" y="277.9649">interrupted</text></g><!--MD5=[8a97136414ef0694178fb8e7ce6e9cb5]
link lloop to *end--><g id="link_lloop_*end"><path d="M427,470.01 C427,517.11 427,558.68 427,579.63 " fill="none" id="lloop-to-*end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="427,584.73,431,575.73,427,579.73,423,575.73,427,584.73" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="433" y="514.897">hasBeenInterrupted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="438.5" y="532.603">&amp;&amp; queueIsEmpty</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="428" y="550.309">&amp;&amp; hasNoActiveTasks</text></g><!--MD5=[e23573c396b67f9ad2c6e794ebb8a9a0]
@startuml loopLogic.svg
hide empty description

state "listening loop" as lloop {

[*] - -> fblock

state "blocked on FIFO read" as fblock
fblock - -> pmes: has data
state "process message" as pmes {
    state status: *send status to client
    state procfile as "proc-file": *proc-file\n*add task to queue\n*send "pending"
    state finished_task : *update running info\n*(monitor already sent "completed")
}

state "process queue" as pqueue: *execute any tasks that are possible\n*send "processing" here

pmes - -> pqueue
pqueue - -> fblock

fblock - -> pqueue: interrupted
}

lloop - -> [*]: hasBeenInterrupted\n&& queueIsEmpty\n&& hasNoActiveTasks
@enduml

PlantUML version 1.2022.4(Sat Apr 09 14:29:17 WEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>