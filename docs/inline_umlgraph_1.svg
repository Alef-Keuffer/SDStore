<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="631px" preserveAspectRatio="none" style="width:841px;height:631px;background:#FFFFFF;" version="1.1" viewBox="0 0 841 631" width="841px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="348.5" y="585"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135" x="353.5" y="610.432">out of listening loop</text><rect fill="#F1F1F1" height="463.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="827.54" x="7" y="7"/><rect fill="#FFFFFF" height="432.2038" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="825.54" x="8" y="37.0679"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="834.54" y1="36.0679" y2="36.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="374.77" y="26.9659">listening loop</text><ellipse cx="457.76" cy="57.0679" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#F1F1F1" height="40" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="381.76" y="104.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="386.76" y="129.4999">blocked on FIFO read</text><g id="lloop.pqueue"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="268" x="323.76" y="383.0679"/><line style="stroke:#181818;stroke-width:0.5;" x1="323.76" x2="591.76" y1="412.1358" y2="412.1358"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="408.26" y="403.0339">process queue</text><ellipse cx="334.26" cy="428.7038" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235" x="341.76" y="432.1018">execute any tasks that are possible</text><ellipse cx="334.26" cy="447.7717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="341.76" y="451.1697">send "processing" here</text></g><rect fill="#F1F1F1" height="147.3396" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="636" x="139.76" y="199.0679"/><rect fill="#FFFFFF" height="116.2717" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="634" x="140.76" y="229.1358"/><line style="stroke:#181818;stroke-width:0.5;" x1="139.76" x2="775.76" y1="228.1358" y2="228.1358"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="399.76" y="219.0339">process message</text><g id="lloop.pmes.status"><rect fill="#F1F1F1" height="58.1358" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="169" x="151.76" y="259.1358"/><line style="stroke:#181818;stroke-width:0.5;" x1="151.76" x2="320.76" y1="288.2038" y2="288.2038"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="215.76" y="279.1018">status</text><ellipse cx="162.26" cy="304.7717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="169.76" y="308.1697">send status to client</text></g><g id="lloop.pmes.procfile"><rect fill="#F1F1F1" height="96.2717" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="154" x="339.26" y="240.1358"/><line style="stroke:#181818;stroke-width:0.5;" x1="339.26" x2="493.26" y1="269.2038" y2="269.2038"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="388.26" y="260.1018">proc-file</text><ellipse cx="349.76" cy="285.7717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="357.26" y="289.1697">proc-file</text><ellipse cx="349.76" cy="304.8396" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="357.26" y="308.2376">add task to queue</text><ellipse cx="349.76" cy="323.9075" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="357.26" y="327.3055">send "pending"</text></g><g id="lloop.pmes.finished_task"><rect fill="#F1F1F1" height="77.2038" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="255" x="511.76" y="249.6358"/><line style="stroke:#181818;stroke-width:0.5;" x1="511.76" x2="766.76" y1="278.7038" y2="278.7038"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="595.26" y="269.6018">finished_task</text><ellipse cx="522.26" cy="295.2717" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="529.76" y="298.6697">update running info</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235" x="516.76" y="317.7376">(monitor already sent "completed")</text></g><!--MD5=[9cab67c1658621a5f0ab8925afbfc4d1]
link *start*lloop to fblock--><g id="link_*start*lloop_fblock"><path d="M457.76,67.1079 C457.76,75.2579 457.76,87.6279 457.76,98.6679 " fill="none" id="*start*lloop-to-fblock" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="457.76,103.9579,461.76,94.9579,457.76,98.9579,453.76,94.9579,457.76,103.9579" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3fcfc0c3f476e413e60df4facbb3fb5d]
link fblock to pmes--><g id="link_fblock_pmes"><path d="M457.76,144.2179 C457.76,157.1979 457.76,175.2879 457.76,193.7579 " fill="none" id="fblock-to-pmes" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="457.76,198.9779,461.76,189.9779,457.76,193.9779,453.76,189.9779,457.76,198.9779" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="458.76" y="176.9649">has data</text></g><!--MD5=[5efc9a4e4c037c5762523f0451d985dc]
link pmes to pqueue--><g id="link_pmes_pqueue"><path d="M457.76,346.2079 C457.76,357.0479 457.76,367.9179 457.76,377.8579 " fill="none" id="pmes-to-pqueue" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="457.76,382.9779,461.76,373.9779,457.76,377.9779,453.76,373.9779,457.76,382.9779" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[987e6092593f91351240b075cfb8351b]
link pqueue to fblock--><g id="link_pqueue_fblock"><path d="M591.88,406.8979 C670.99,395.7579 760.3,376.7379 784.76,346.0679 C825.51,294.9979 825.54,250.1079 784.76,199.0679 C754.57,161.2779 625.77,141.3679 539.11,132.0479 " fill="none" id="pqueue-to-fblock" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="533.99,131.5079,542.5167,136.437,538.962,132.0365,543.3625,128.4819,533.99,131.5079" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[db1daee58f179c2188b9f7e94e5c8bb9]
link fblock to pqueue--><g id="link_fblock_pqueue"><path d="M381.44,128.0479 C277.54,133.8879 99.86,150.8279 59.76,199.0679 C18,249.3079 18.03,295.7979 59.76,346.0679 C92.52,385.5279 217.23,404.2079 318.43,412.9779 " fill="none" id="fblock-to-pqueue" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="323.54,413.4179,314.9168,408.6597,318.5585,412.9885,314.2297,416.6301,323.54,413.4179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="60.76" y="277.9649">interrupted</text></g><!--MD5=[9725512e0d43a69d55a6dc2746c1c52a]
link lloop to olloop--><g id="link_lloop_olloop"><path d="M421,470.08 C421,514.55 421,554.88 421,579.4 " fill="none" id="lloop-to-olloop" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="421,584.68,425,575.68,421,579.68,417,575.68,421,584.68" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="427" y="514.897">hasBeenInterrupted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="432.5" y="532.603">&amp;&amp; queueIsEmpty</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="422" y="550.309">&amp;&amp; hasNoActiveTasks</text></g><!--MD5=[48df9718229ba7e00ee2bf2faa1a59e5]
@startuml inline_umlgraph_1.svg
hide empty description

state "listening loop" as lloop {

[*] - -> fblock

state "blocked on FIFO read" as fblock
fblock - -> pmes: has data
state "process message" as pmes {
    state status: *send status to client
    state procfile as "proc-file": *proc-file\n*add task to queue\n*send "pending"
    state finished_task : *update running info\n(monitor already sent "completed")
}

state "process queue" as pqueue: *execute any tasks that are possible\n*send "processing" here

pmes - -> pqueue
pqueue - -> fblock

fblock - -> pqueue: interrupted
}

lloop - -> olloop: hasBeenInterrupted\n&& queueIsEmpty\n&& hasNoActiveTasks
state "out of listening loop" as olloop
@enduml

PlantUML version 1.2022.4(Sat Apr 09 14:29:17 WEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>